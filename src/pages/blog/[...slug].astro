---
import type { GhostPost } from '../../types/ghost'
import Layout from '../../layouts/BlogPostLayout.astro'
import { getAllPosts } from '../../lib/ghost'

export async function getStaticPaths() {
	const posts = await getAllPosts()
	return posts.map((post: GhostPost) => ({
		params: { slug: post.slug },
		props: { post },
	}))
}

interface Props {
	post: GhostPost
}

const { post } = Astro.props
---

<Layout
	title={post.title}
	pubDate={new Date(post.published_at)}
	heroImage={post.feature_image}
	description={post.excerpt}
>
	<article class="prose prose-purple lg:prose-lg mx-auto">
		<Fragment set:html={post.html} />
	</article>
</Layout>

<style is:global>
	/* Ghost Bookmark Card Styles */
	figure.kg-bookmark-card {
		border: 1px solid #e5e7eb;
		margin-bottom: 20px;
		margin-top: 20px;
		margin-right: 0;
		margin-left: 0;
		border-radius: 8px;
		overflow: hidden;
		background: white;
	}

	.kg-bookmark-container {
		display: flex;
		flex-wrap: wrap;
		text-decoration: none;
		border: none !important;
		color: inherit;
	}

	.kg-bookmark-content {
		flex-basis: 0;
		flex-grow: 999;
		min-width: 50%;
		padding: 20px;
		color: inherit;
	}

	.kg-bookmark-title {
		font-weight: 500;
		font-size: 20px;
		line-height: 1.3;
		color: #111827;
		margin-bottom: 8px !important;
	}

	.kg-bookmark-description {
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
		color: #6b7280;
		font-weight: 400;
		font-size: 14px;
		line-height: 1.5;
	}

	.kg-bookmark-metadata {
		display: flex;
		align-items: center;
		margin-top: 12px;
		color: #6b7280;
		font-weight: 400;
		font-size: 14px;
	}

	.kg-bookmark-thumbnail {
		flex-basis: 25%;
		flex-grow: 1;
	}

	.kg-bookmark-thumbnail img {
		vertical-align: bottom;
		object-fit: cover;
		width: 100%;
		height: 100%;
	}

	.kg-bookmark-icon {
		width: 20px;
		height: 20px;
		margin-right: 6px;
		vertical-align: bottom;
	}

	.kg-bookmark-author:after {
		content: 'â€¢';
		margin: 0 6px;
	}

	/* Some added styling for iPhone portrait */
	@media only screen and (min-device-width: 375px) and (max-device-width: 667px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: portrait) {
		figure.kg-bookmark-card {
			margin-bottom: 20px;
			margin-top: 20px;
		}
	}
</style>
